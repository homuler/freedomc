var timeBar=d3.select("#score-bar").append("div").attr("class","score-bar");timeBar.selectAll("div").data([10]).enter().append("div").style("width",function(d){return d*10*"px"}).text(function(d){return d});var timeBar=d3.select("#time-bar").append("div").attr("class","time-bar");timeBar.selectAll("div").data([10]).enter().append("div").style("width",function(d){return d*10*"px"}).text(function(d){return d});var fc=fc||{};fc.graphics=fc.graphics||{};console.log("graphics");(function(ns){ns.speedGauge=function(container,configuration){var that={},config={size:200,clipWidth:200,clipHeight:110,ringInset:20,ringWidth:20,pointerWidth:10,pointerTailLength:5,pointerHeadLengthPercent:0.9,minValue:0,maxValue:10,minAngle:-120,maxAngle:120,transitionMs:750,majorTicks:5,labelFormat:d3.format(',g'),labelInset:10,arcColorFn:d3.interpolateHsl(d3.rgb('#e8e2ca'),d3.rgb('#3e6c0a'))},range=undefined,r=undefined,pointerHeadLength=undefined,value=0,svg=undefined,arc=undefined,scale=undefined,ticks=undefined,tickData=undefined,pointer=undefined,donut=d3.layout.pie()
function deg2rad(deg){return deg*Math.PI/180}
function newAngle(d){var ratio=scale(d),newAngle=config.minAngle+(ratio*range);return newAngle}
function configure(configuration){var prop=undefined;for(prop in configuration)config[prop]=configuration[prop];range=config.maxAngle-config.minAngle;r=config.size/2;pointerHeadLength=Math.round(r*config.pointerHeadLengthPercent);scale=d3.scale.linear().range([0,1]).domain([config.minValue,config.maxValue]);ticks=scale.ticks(config.majorTicks);tickData=d3.range(config.majorTicks).map(function(){return 1/config.majorTicks});arc=d3.svg.arc().innerRadius(r-config.ringWidth-config.ringInset).outerRadius(r-config.ringInset).startAngle(function(d,i){var ratio=d*i;return deg2rad(config.minAngle+(ratio*range))}).endAngle(function(d,i){var ratio=d*(i+1);return deg2rad(config.minAngle+(ratio*range))})};that.configure=configure
function centerTranslation(){return 'translate('+r+','+r+')'}
function isRendered(){return(svg!==undefined)};that.isRendered=isRendered
function render(newValue){svg=d3.select(container).append('svg:svg').attr('class','gauge').attr('width',config.clipWidth).attr('height',config.clipHeight);var centerTx=centerTranslation(),arcs=svg.append('g').attr('class','arc').attr('transform',centerTx);arcs.selectAll('path').data(tickData).enter().append('path').attr('fill',function(d,i){return config.arcColorFn(d*i)}).attr('d',arc);var lg=svg.append('g').attr('class','label').attr('transform',centerTx);lg.selectAll('text').data(ticks).enter().append('text').attr('transform',function(d){var ratio=scale(d),newAngle=config.minAngle+(ratio*range);return 'rotate('+newAngle+') translate(0,'+(config.labelInset-r)+')'}).text(config.labelFormat);var lineData=[[config.pointerWidth/2,0],[0,-pointerHeadLength],[-(config.pointerWidth/2),0],[0,config.pointerTailLength],[config.pointerWidth/2,0]],pointerLine=d3.svg.line().interpolate('monotone'),pg=svg.append('g').data([lineData]).attr('class','pointer').attr('transform',centerTx);pointer=pg.append('path').attr('d',pointerLine).attr('transform','rotate('+config.minAngle+')');update(newValue===undefined?0:newValue)};that.render=render
function update(newValue,newConfiguration){if(newConfiguration!==undefined)configure(newConfiguration);var ratio=scale(newValue),newAngle=config.minAngle+(ratio*range);pointer.transition().duration(config.transitionMs).ease('elastic').attr('transform','rotate('+newAngle+')')};that.update=update;configure(configuration);return that}})(fc.graphics);var fc=fc||{};fc.graphics=fc.graphics||{};fc.graphics.scoreSpec=fc.graphics.scoreSpec||{};(function(ns){ns.data=[{value:800000,color:"#F7464A",highlight:"#FF5A5E",label:"Correct"},{value:800000,color:"#46BFBD",highlight:"#5AD3D1",label:"Combo"},{value:800000,color:"#FDB45C",highlight:"#FFC870",label:"Speed"},{value:800000,color:"#949FB1",highlight:"#A8B3C5",label:"Bonus"},{value:800000,color:"#4D5360",highlight:"#616774",label:"Miss"}];ns.options={scaleShowLabelBackdrop:true,scaleBackdropColor:"rgba(255,255,255,0.75)",scaleBeginAtZero:true,scaleBackdropPaddingY:2,scaleBackdropPaddingX:2,scaleShowLine:true,segmentShowStroke:true,segmentStrokeColor:"#fff",segmentStrokeWidth:2,animationSteps:100,animationEasing:"easeOutBounce",animateRotate:true,animateScale:false,legendTemplate:"<ul class=\"<%=name.toLowerCase()%>-legend\"><% for (var i=0; i<segments.length; i++){%><li><span style=\"background-color:<%=segments[i].fillColor%>\"></span><%if(segments[i].label){%><%=segments[i].label%><%}%></li><%}%></ul>"}})(fc.graphics.scoreSpec);var fc=fc||{};fc.graphics=fc.graphics||{};fc.graphics.speedGraph=fc.graphics.speedGraph||{};(function(ns){ns.data={labels:["","0:00"],datasets:[{label:"Speed Graph",fillColor:"rgba(220,220,220,0.2)",strokeColor:"rgba(220,220,220,1)",pointColor:"rgba(220,220,220,1)",pointStrokeColor:"#fff",pointHighlightFill:"#fff",pointHighlightStroke:"rgba(220,220,220,1)",data:[0,0]},]};ns.options={scaleShowGridLines:true,scaleGridLineColor:"rgba(0,0,0,.05)",scaleGridLineWidth:1,bezierCurve:true,bezierCurveTension:0.4,pointDot:true,pointDotRadius:4,pointDotStrokeWidth:1,pointHitDetectionRadius:20,datasetStroke:true,datasetStrokeWidth:2,datasetFill:true,legendTemplate:"<ul class=\"<%=name.toLowerCase()%>-legend\"><% for (var i=0; i<datasets.length; i++){%><li><span style=\"background-color:<%=datasets[i].lineColor%>\"></span><%if(datasets[i].label){%><%=datasets[i].label%><%}%></li><%}%></ul>"}})(fc.graphics.speedGraph);var fc=fc||{};fc.graphics=fc.graphics||{};fc.graphics.scoreGraph=fc.graphics.scoreGraph||{};(function(ns){ns.data={labels:["","0:00"],datasets:[{label:"Speed Graph",fillColor:"rgba(220,220,220,0.2)",strokeColor:"rgba(220,220,220,1)",pointColor:"rgba(220,220,220,1)",pointStrokeColor:"#fff",pointHighlightFill:"#fff",pointHighlightStroke:"rgba(220,220,220,1)",data:[0,0]}]};ns.options={scaleShowGridLines:true,scaleGridLineColor:"rgba(0,0,0,.05)",scaleGridLineWidth:1,bezierCurve:true,bezierCurveTension:0.4,pointDot:true,pointDotRadius:4,pointDotStrokeWidth:1,pointHitDetectionRadius:20,datasetStroke:true,datasetStrokeWidth:2,datasetFill:true,legendTemplate:"<ul class=\"<%=name.toLowerCase()%>-legend\"><% for (var i=0; i<datasets.length; i++){%><li><span style=\"background-color:<%=datasets[i].lineColor%>\"></span><%if(datasets[i].label){%><%=datasets[i].label%><%}%></li><%}%></ul>"}})(fc.graphics.scoreGraph);var fc=fc||{};fc.typing=fc.typing||{};fc.typing.status=fc.typing.status||{};fc.typing.events=fc.typing.events||{};fc.typing.events.postRecord=function(){var playInfo=fc.typing.status.playInfo,gameInfo=fc.typing.status.gameInfo,postBtn=this;$('<form/>',{action:'http://local.homulerdora.org:3000/freedomc/typing/game',method:'post'}).append($('<input/>',{type:'hidden',name:'score-sum-val',value:playInfo.scoreFuncs.getScoreSum()})).append($('<input/>',{type:'hidden',name:'difficulty-val',value:fc.typing.constants.difficulties[gameInfo.difficulty]})).appendTo(document.body).submit()};window.onload=function(){$("div.navbar-fixed-top").autoHidingNavbar({showOnUpscroll:true,showOnButton:true,animationDuration:200});console.log("onload event");var gameInfo=fc.typing.status.gameInfo,playInfo=fc.typing.status.playInfo;gameInfo.problemData={"lyricSrc":"static/music/stapleStable/lyric.txt","musician":"斎藤　千和","musicSrc":"/static/music/stapleStable/staple_stable.mp3","format":"Sound","title":"Staple Stable","problems":[{"display":"今ならまだ間に合うから","startTime":16.268,"endTime":19.761,"problem":"いまならまだまにあうから"},{"display":"撤回した方がいいよ","startTime":20.004,"endTime":23.486,"problem":"てっかいしたほうがいいよ"},{"display":"もっと勘違いしてしまう前に","startTime":23.71,"endTime":28.724,"problem":"もっとかんちがいしてしまうまえに"},{"display":"君をとじた　言葉の針","startTime":31.134,"endTime":34.68,"problem":"きみをとじた　ことばのはり"},{"display":"いつの間にか　この胸に","startTime":34.886,"endTime":37.848,"problem":"いつのまにか　このむねに"},{"display":"刺さってしまってた..痛い","startTime":37.848,"endTime":43.263,"problem":"ささってしまってた..いたい"},{"display":"君のせいだよ","startTime":43.678,"endTime":45.585,"problem":"きみのせいだよ"},{"display":"来ないで","startTime":46.026,"endTime":47.106,"problem":"こないで"},{"display":"こんな　こんな私を","startTime":47.277,"endTime":49.259,"problem":"こんな　こんなわたしを"},{"display":"見ないで","startTime":49.751,"endTime":50.842,"problem":"みないで"},{"display":"そんな　そんなとこまで","startTime":51.029,"endTime":52.991,"problem":"そんな　そんなとこまで"},{"display":"話さないで","startTime":53.503,"endTime":54.485,"problem":"はなさないで"},{"display":"あんな　あんな笑顔で","startTime":54.675,"endTime":56.484,"problem":"あんな　あんなえがおで"},{"display":"どんな誰にも","startTime":56.69,"endTime":60.847,"problem":"どんなだれにも"},{"display":"どこまででも続く","startTime":61.801,"endTime":63.744,"problem":"どこまででもつづく"},{"display":"この空のような","startTime":63.933,"endTime":65.284,"problem":"このそらのような"},{"display":"終わりのない永遠を誓って","startTime":65.59,"endTime":69.062,"problem":"おわりのないえいえんをちかって"},{"display":"いじわるで優しい","startTime":69.288,"endTime":71.295,"problem":"いじわるでやさしい"},{"display":"その海のような","startTime":71.429,"endTime":72.68,"problem":"そのうみのような"},{"display":"心に飛び込んだら受け止めて","startTime":72.995,"endTime":76.415,"problem":"こころにとびこんだらうけとめて"},{"display":"重さじゃ量れない　こんな想い","startTime":76.587,"endTime":84.603,"problem":"おもさじゃはかれない　こんなおもい"},{"display":"君だけに今伝えるから","startTime":85.099,"endTime":91.389,"problem":"きみだけにいまつたえるから"},{"display":"未来はまだ決まってない","startTime":103.679,"endTime":107.182,"problem":"みらいはまだきまってない"},{"display":"それが希望だったのにね","startTime":107.44,"endTime":110.959,"problem":"それがきぼうだったのにね"},{"display":"いつから なぜ 不安に変わった?","startTime":111.202,"endTime":115.783,"problem":"いつから なぜ ふあんにかわった"},{"display":"こういう時　こういう事","startTime":118.597,"endTime":121.857,"problem":"こういうとき　こういうこと"},{"display":"云える相手　思い浮かべてみた","startTime":122.316,"endTime":127.139,"problem":"いえるあいて　おもいうかべてみた"},{"display":"真っ先に..やっぱ","startTime":127.139,"endTime":130.684,"problem":"まっさきに..やっぱ"},{"display":"君だけなんだ","startTime":131.089,"endTime":132.99,"problem":"きみだけなんだ"},{"display":"探して","startTime":133.448,"endTime":134.5,"problem":"さがして"},{"display":"あんな　あんな私も","startTime":134.734,"endTime":136.723,"problem":"あんな　あんなわたしも"},{"display":"見抜いて","startTime":137.192,"endTime":138.216,"problem":"みぬいて"},{"display":"こんな　こんなとこまで","startTime":138.415,"endTime":140.447,"problem":"こんな　こんなとこまで"},{"display":"放さないで","startTime":140.915,"endTime":141.967,"problem":"はなさないで"},{"display":"そんな　そんな笑顔で","startTime":142.133,"endTime":143.93,"problem":"そんな　そんなえがおで"},{"display":"どんな時にも","startTime":144.172,"endTime":148.123,"problem":"どんなときにも"},{"display":"どこまでも続く","startTime":149.293,"endTime":151.164,"problem":"どこまでもつづく"},{"display":"この空のような","startTime":151.408,"endTime":152.703,"problem":"このそらのような"},{"display":"終わりのない永遠を誓って","startTime":152.975,"endTime":156.483,"problem":"おわりのないえいえんをちかって"},{"display":"いじわるで優しい","startTime":156.743,"endTime":158.776,"problem":"いじわるでやさしい"},{"display":"その海のような","startTime":158.984,"endTime":160.145,"problem":"そのうみのような"},{"display":"心に飛び込んだら受け止めて","startTime":160.431,"endTime":163.969,"problem":"こころにとびこんだらうけとめて"},{"display":"重さじゃ量れない　こんな想い","startTime":163.969,"endTime":172.015,"problem":"おもさじゃはかれない　こんなおもい"},{"display":"君だけに今伝えるから","startTime":172.517,"endTime":178.269,"problem":"きみだけにいまつたえるから"},{"display":"並んで寝転んで","startTime":198.613,"endTime":201.817,"problem":"ならんでねころんで"},{"display":"見上げた星空に","startTime":202.303,"endTime":204.706,"problem":"みあげたほしぞらに"},{"display":"描いていく星座","startTime":205.154,"endTime":208.528,"problem":"えがいてくせいざ"},{"display":"二人だけの物語","startTime":208.844,"endTime":212.515,"problem":"ふたりだけのストーリー"},{"display":"願いを叶えて","startTime":212.812,"endTime":214.755,"problem":"ねがいをかなえて"},{"display":"光る流れ星","startTime":214.755,"endTime":219.777,"problem":"ひかるながれぼし"},{"display":"もどかしすぎる距離","startTime":220.022,"endTime":221.939,"problem":"もどかしすぎるきょり"},{"display":"背伸びしてみた","startTime":222.237,"endTime":223.605,"problem":"せのびしてみた"},{"display":"今日はね　これが私の精一杯","startTime":223.81,"endTime":227.444,"problem":"きょうはね　これがわたしのせいいっぱい"},{"display":"不確かで些細な","startTime":227.444,"endTime":229.486,"problem":"ふたしかでささいな"},{"display":"毎日だけど","startTime":229.486,"endTime":230.836,"problem":"まいにちだけど"},{"display":"明日も隣で笑えるように","startTime":231.114,"endTime":234.671,"problem":"あしたもとなりでわらえるように"},{"display":"どこまででも続く","startTime":234.905,"endTime":236.719,"problem":"どこまででもつづく"},{"display":"この空のような","startTime":237.008,"endTime":238.314,"problem":"このそらのような"},{"display":"終わりのない永遠を誓って","startTime":238.601,"endTime":242.084,"problem":"おわりのないえいえんをちかって"},{"display":"いじわるで優しい","startTime":242.31,"endTime":244.243,"problem":"いじわるでやさしい"},{"display":"その海のような","startTime":244.425,"endTime":245.738,"problem":"そのうみのような"},{"display":"心に飛び込んだら受け止めて","startTime":246.054,"endTime":249.536,"problem":"こころにとびこんだらうけとめて"},{"display":"重さじゃ量れない　こんな想い","startTime":249.536,"endTime":257.607,"problem":"おもさじゃはかれない　こんなおもい"},{"display":"君だけに今伝えるから","startTime":258.083,"endTime":264.005,"problem":"きみだけにいまつたえるから"}],"genre":["Anime"],"pictureSrc":"/static/music/stapleStable/staple_stable_.png"}.problems;$(document).on("keypress",fc.typing.events.keyPressEvent);$(document).on("keydown",fc.typing.events.controlWithKeys);playInfo.flag.loaded=true;gameInfo.setProblemList();gameInfo.difficulty=gameInfo.evalDifficulty(gameInfo.problemData);fc.typing.graphics.renderGraphics();playInfo.scoreConstants.resetValue();console.log("loaded");console.log(fc.typing.status.gameInfo);$("#post-btn").on("click",function(e){console.log("form called");e.preventDefault();fc.typing.events.postRecord()});$("#cancel-btn").on("click",function(e){location.href='http://local.homulerdora.org:3000/freedomc/typing'})}